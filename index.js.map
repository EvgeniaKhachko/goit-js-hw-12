{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\n\nexport async function fetchImages(searchString, pageToLoad = 1)\n{\n    const API_URL = 'https://pixabay.com/api/';\n    const API_KEY = '46129097-db92c21a9f578a732dd89224e';\n    const IMAGES_QTY = 15; \n    \n    const requestParams = {\n      key: API_KEY,\n      q: encodeURIComponent(searchString),\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      per_page: IMAGES_QTY,\n      page: pageToLoad\n    };\n    const encodedParams = new URLSearchParams(requestParams);\n \n    const response = await axios.get([API_URL, encodedParams].join('?'));\n\n    return response['data'];\n}","export function showGallery(images)\n{\n    let imageHTML = '';\n    images.forEach(image => {\n      imageHTML += `\n      <a class=\"gallery__item\" href=\"${image.largeImageURL}\">\n      <figure class=\"gallery__figure\">\n        <img class=\"gallery__img\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\">\n        <figcaption class=\"gallery__figcaption\">\n          <div class=\"gallery__caption\">Likes: ${image.likes}</div>\n          <div class=\"gallery__caption\">Views: ${image.views}</div>\n          <div class=\"gallery__caption\">Comments: ${image.comments}</div>\n          <div class=\"gallery__caption\">Downloads: ${image.downloads}</div>\n    </figcaption>\n      </figure>\n    </a>`;\n    });\n\n    return imageHTML;\n}","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport {fetchImages} from \"./js/pixabay-api.js\";\nimport {showGallery} from \"./js/render-functions.js\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nconst gallery = document.querySelector('.gallery');\nconst lightbox = new SimpleLightbox('.gallery .gallery__item');\nconst loaderElement = document.querySelector('.loader');\nconst queryElement = document.querySelector('input');\nconst moreButton = document.querySelector('#show-more');\nconst formEl = document.querySelector('.feedback-form');\n\nlet currentPage = 1;  \nlet totalHits = 0;\nlet lastPage = 0;\nlet currentQuery = '';\nconst imagesPerPage = 15;\nmoreButton.style.display = 'none';\n\nfunction resetToStart() {\n  currentPage = 1;  \n  totalHits = 0;\n  lastPage = 0;\n  currentQuery = '';\n  moreButton.style.display = 'none';\n}\nmoreButton.addEventListener('click', function(event) {\n  document.querySelector('form button').click();\n});\n\n\nformEl.addEventListener('submit', function(event) {\n  event.preventDefault();\n\n  loaderElement.style.display = 'block';\n  const query = queryElement.value.trim();\n  \n  if (query === '') {\n    loaderElement.style.display = 'none';\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter a search query!',\n    });\n\n    return;\n  }\n\n  if (currentQuery != query) {\n    resetToStart();\n    gallery.innerHTML = '';\n    currentQuery = query;\n  }\n\nfetchImages(currentQuery, currentPage)\n    .then(data => {\n      if (data.totalHits && (data.totalHits > 0)) {\n        totalHits = data.totalHits\n        lastPage = Math.ceil(totalHits/imagesPerPage);\n        const imagesForDisplay = data.hits; \n        const imageHTML = showGallery(imagesForDisplay);\n\n        gallery.innerHTML += imageHTML;\n        let imageDomRect = document.querySelector(\"a.gallery__item\").getBoundingClientRect();\n        let heightToScroll = imageDomRect.height * 2; \n\n        if (currentPage != 1) {\n          window.scrollBy({\n            top: heightToScroll,\n            behavior: \"smooth\"\n          });\n        }\n\n        lightbox.refresh();\n\n        if (currentPage == lastPage) {\n          resetToStart();\n          iziToast.error({\n            title: 'Info',\n            message: \"We're sorry, but you've reached the end of search results.\",\n          });\n              \n        } else {\n          moreButton.style.display = 'block';\n          currentPage++;\n        }\n\n      } else {\n        resetToStart();\n        iziToast.error({\n          title: 'Error',\n          message: 'Sorry, there are no images matching your search query. Please try again!',\n        });\n      }\n      loaderElement.style.display = 'none';\n    })\n    .catch(error => {\n      loaderElement.style.display = 'none';\n      console.log(error.message);\n    });\n\n});\n"],"names":["fetchImages","searchString","pageToLoad","API_URL","requestParams","encodedParams","axios","showGallery","images","imageHTML","image","gallery","lightbox","SimpleLightbox","loaderElement","queryElement","moreButton","formEl","currentPage","totalHits","lastPage","currentQuery","imagesPerPage","resetToStart","event","query","iziToast","data","imagesForDisplay","heightToScroll","error"],"mappings":"owBAGO,eAAeA,EAAYC,EAAcC,EAAa,EAC7D,CACI,MAAMC,EAAU,2BAIVC,EAAgB,CACpB,IAJc,qCAKd,EAAG,mBAAmBH,CAAY,EAClC,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,SAAU,GACV,KAAMC,CACZ,EACUG,EAAgB,IAAI,gBAAgBD,CAAa,EAIvD,OAFiB,MAAME,EAAM,IAAI,CAACH,EAASE,CAAa,EAAE,KAAK,GAAG,CAAC,GAEnD,IACpB,CCvBO,SAASE,EAAYC,EAC5B,CACI,IAAIC,EAAY,GAChB,OAAAD,EAAO,QAAQE,GAAS,CACtBD,GAAa;AAAA,uCACoBC,EAAM,aAAa;AAAA;AAAA,yCAEjBA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA,iDAE9BA,EAAM,KAAK;AAAA,iDACXA,EAAM,KAAK;AAAA,oDACRA,EAAM,QAAQ;AAAA,qDACbA,EAAM,SAAS;AAAA;AAAA;AAAA,SAIpE,CAAK,EAEMD,CACX,CCZA,MAAME,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAW,IAAIC,EAAe,yBAAyB,EACvDC,EAAgB,SAAS,cAAc,SAAS,EAChDC,EAAe,SAAS,cAAc,OAAO,EAC7CC,EAAa,SAAS,cAAc,YAAY,EAChDC,EAAS,SAAS,cAAc,gBAAgB,EAEtD,IAAIC,EAAc,EACdC,EAAY,EACZC,EAAW,EACXC,EAAe,GACnB,MAAMC,EAAgB,GACtBN,EAAW,MAAM,QAAU,OAE3B,SAASO,GAAe,CACtBL,EAAc,EACdC,EAAY,EACZC,EAAW,EACXC,EAAe,GACfL,EAAW,MAAM,QAAU,MAC7B,CACAA,EAAW,iBAAiB,QAAS,SAASQ,EAAO,CACnD,SAAS,cAAc,aAAa,EAAE,MAAK,CAC7C,CAAC,EAGDP,EAAO,iBAAiB,SAAU,SAASO,EAAO,CAChDA,EAAM,eAAc,EAEpBV,EAAc,MAAM,QAAU,QAC9B,MAAMW,EAAQV,EAAa,MAAM,KAAI,EAErC,GAAIU,IAAU,GAAI,CAChBX,EAAc,MAAM,QAAU,OAC9BY,EAAS,MAAM,CACb,MAAO,QACP,QAAS,8BACf,CAAK,EAED,MACD,CAEGL,GAAgBI,IAClBF,IACAZ,EAAQ,UAAY,GACpBU,EAAeI,GAGnBzB,EAAYqB,EAAcH,CAAW,EAChC,KAAKS,GAAQ,CACZ,GAAIA,EAAK,WAAcA,EAAK,UAAY,EAAI,CAC1CR,EAAYQ,EAAK,UACjBP,EAAW,KAAK,KAAKD,EAAUG,CAAa,EAC5C,MAAMM,EAAmBD,EAAK,KACxBlB,EAAYF,EAAYqB,CAAgB,EAE9CjB,EAAQ,WAAaF,EAErB,IAAIoB,EADe,SAAS,cAAc,iBAAiB,EAAE,sBAAqB,EAChD,OAAS,EAEvCX,GAAe,GACjB,OAAO,SAAS,CACd,IAAKW,EACL,SAAU,QACtB,CAAW,EAGHjB,EAAS,QAAO,EAEZM,GAAeE,GACjBG,IACAG,EAAS,MAAM,CACb,MAAO,OACP,QAAS,4DACrB,CAAW,IAGDV,EAAW,MAAM,QAAU,QAC3BE,IAGV,MACQK,IACAG,EAAS,MAAM,CACb,MAAO,QACP,QAAS,0EACnB,CAAS,EAEHZ,EAAc,MAAM,QAAU,MACpC,CAAK,EACA,MAAMgB,GAAS,CACdhB,EAAc,MAAM,QAAU,OAC9B,QAAQ,IAAIgB,EAAM,OAAO,CAC/B,CAAK,CAEL,CAAC"}